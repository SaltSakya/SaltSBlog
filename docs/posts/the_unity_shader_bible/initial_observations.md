---
title: 1 初步观察
icon: module
#cover: /assets/images/Touch Fish Time.jpg
date: 2022-06-10
orderGetter: 0
category:
  - Unity Shader 圣经
tag:
  - shader
  - Unity
  - CG
---

许多年前，当我刚开始学习 Unity 中的 Shader 时，理解书中的许多内容是一项巨大的挑战。我仍记得那天的学习，我想要理解语义 `POSITION[n]` 的操作；然而，当我想找到它的定义时，我发现了如下的陈述：
> Vertex position in object-space.  
> 物体空间的顶点位置。  

那一刻，我问自己，啥叫物体空间的顶点位置？然后我意识到，在开始学习之前，我必须要知道这一学科的一些基础知识。

在我的经验中，我可以说出至少四个有助于理解着色器和他们的结构的基本领域，如**多边形物体属性**、**渲染管线结构**、**矩阵**和**坐标系统**。

<!-- more -->

## 1.1 多边形物体属性
英语中 polygon 一词来自希腊语，它由 poly（多）和 gnow（角）组成。根据定义，一个多边形代表一个以若干线段作为边界的封闭平面图形。

![Fig 1.1a](/unityshaderbible/13-0.png)

**基本体**是一个由多边形构成的三维几何物体，在不同的开发软件中作为预定义的物体。在 Unity、Maya、Blender 中，我们可以找到其他基本体，最常见的有：球体、盒体、四边形、圆柱体和胶囊体。这些物体有着不同的形状，但属性相似；都有*顶点*、*切线*、*法线*、*UV坐标*和*颜色*，这些属性存储在一个叫“*网格*”的数据类型中。

我们可以在着色器中独立地访问所有这些属性，并把他们保存在向量中（如`float4 pos: POSITION[n]`）。这样很好，因为我们可以修改它们的值，并以此创造激动人心的效果。为了更好地理解这个概念，我们将对多边形的属性下一个定义。

![Fig 1.1b](/unityshaderbible/14-0.png)

### 1.1.1 顶点

物体的顶点，对应于一组在二维或三维空间中定义的表面区域的点。在 Maya 或 Blender 中，顶点表示为网格和物体的交点。

这些点主要有两个特点：
1. 他们是 `Transform` 组件的子级。
2. 他们有根据物体总体积的中心定义的位置。

这是什么意思？假设，在 Maya 3D，有两个默认的节点关联到一个物体。这两个节点称为**变换**和**形状**。变换节点和 Unity 中一样，定义了一个物体关于其轴心的位置、旋转和缩放。而形状节点，作为变换节点的子节点，则包含几何属性，是物体的顶点关于其体积的位置。这意味着我们可以移动、旋转或缩放物体的顶点集，但同时，我们也可以改变某个或者某些指定顶点的位置。

前文中举例提到的 `POSITION[n]` 正是允许访问与体积有关的顶点位置的语义，即访问形状节点从Maya导出的配置的语义。

![Fig 1.1.1a 左图可见 Maya 中的变换节点，右图则是形状节点](/unityshaderbible/15-0.png)

### 1.1.2 法线

我们来想象一下，假设我们有一张白纸，我们让一个朋友在这张纸的正面画点东西。如果白纸的两面都一样，那我们要如何确定哪一面才是白纸的正面呢？这就是**法线**存在的意义。法线对应于多边形表面的垂直向量，其用来决定一个面或顶点的方向或朝向。

Maya 中，我们可以通过选择属性**顶点法线**来可视化物体的法线。这让我们可以看见顶点在空间中的位置，并决定物体不同表面之间的硬度。

![Fig 1.1.2a 每个顶点法线的图形学表示](/unityshaderbible/15-1.png)

## 1.1.3 切线

根据 Unity 的官方文档[^1]：

> 切线是单位长度的矢量，它顺着网格表面沿水平纹理方向。

这是什么意思？切线沿着每个几何体平面上 UV 坐标的 U 方向。

![Fig 1.1.3a 默认情况下，我们无法在着色器中获取到副法线。因此，我们必须使用法线和切线来计算它。](/unityshaderbible/16-0.png)

之后在[第Ⅱ章 6.0.1 节](/posts/the_unity_shader_bible/surface.html#_6-1-法线贴图) 中，我们会详细回顾此属性，包括在物体上的实现法线贴图的副法线。

## 1.0.5 UV 坐标
## 1.0.6 顶点颜色
## 1.0.7 渲染管线架构
## 1.0.8 应用阶段
## 1.0.9 几何处理阶段
## 1.1.0 光栅化阶段
## 1.1.1 像素处理阶段
## 1.1.2 渲染管线类型
## 1.1.3 正向渲染
## 1.1.4 延迟渲染
## 1.1.5 我该使用什么渲染引擎？
## 1.1.6 矩阵和坐标系统

## 参考
[^1]: [Mesh - Tangents - Unity 脚本 API](https://docs.unity.cn/cn/2022.1/ScriptReference/Mesh-tangents.html)